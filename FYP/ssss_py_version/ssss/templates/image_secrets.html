<!DOCTYPE html>
<html>
    <head>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
        <style>
            body {
                margin: 10px;
            }
        </style>
        <script type="text/javascript">
            function submit() {
                var selectedFile = document.querySelector('#imagefile').files[0];
                var formData = new FormData();
                formData.append('file', selectedFile);

                $.ajax({
                type: 'POST',
                url: '/img_split',
                data: formData,
                processData: false,
                contentType: false,
                success:function(fp) {
                    var img = document.getElementById("preview");
                    img.src = fp
                }});
            }

            function check_shares() {
                var valid = true;
                var selectedFile = document.getElementById("imagefile");
                //TODO: check the shares function

                if ("" == selectedFile.value) {
                    valid = false;
                }
                if (Boolean(valid) === false) {
                    alert("No file selected.")
                }
                if (Boolean(valid) === true) {
                    //$.ajax( {
                      //  type: 'POST',
                      //  url: '/img_combine',
                      //  data: {},
                      //  processData: false,
                      //  contentType: false,
                      //  success:function() {}
                    //});
                    window.location.href = "/img_combine";
                }
            }
        </script>

    </head>

    <body>

    <p>
        Input your image secret:
    </p>

    <input type="file" name="file" id="imagefile" accept=".jpg, .jpeg, .png">
    <input type=submit id="img_btn" onclick="submit()">

    <div>
        <img src="" id="preview">
    </div>

    <br /><br />
    <a href="{{ url_for('img_combine') }}">Go check the shares!</a>
    <input type="button" id="combine_btn" value="Download Shares" onclick="check_shares()">
    <br /> <br />
        <a href="{{ url_for('index') }}">Back to Main Page</a>
    </body>

</html>